import{c as I,be as q,W as O,U as r,s as h,aP as T,o as d,l as _,i as n,j as p,e as u,F as j,B,f as E,m as R,g as m,w as f,C as D}from"./main.e5722c22.js";import{V as N}from"./vue-cookies.aacfa879.js";import{u as L}from"./useAppAbility.977f44d8.js";import{V as F}from"./VTextField.c7d5535f.js";import{V as K}from"./VBtn.4327307d.js";import{a as v}from"./VRow.f8de802a.js";const J={class:"text-base font-weight-bold mb-3"},P={class:"d-flex justify-center align-center flex-wrap"},U={class:"me-1"},W={href:"#"},X={__name:"EmailOtpInput",props:{totalInput:{type:Number,required:!1,default:6},default:{type:String,required:!1,default:""}},emits:["updateOtp"],setup(b,{emit:k}){const y=b,{isAppRtl:S}=I(),c=q(),g=O();r.defaults.headers.common["Content-Type"]="application/json",r.defaults.headers.common.Accept="application/json",S.value===!0?r.defaults.headers.common.Language="ar":r.defaults.headers.common.Language="en",r.defaults.headers.common.type="Customer";const s=h([]),l=h(null),x=L();s.value=y.default.split("");const V={style:"max-width: 54px; text-align: center;"},w=(e,t)=>{if(e.code!=="Tab"&&e.code!=="ArrowRight"&&e.code!=="ArrowLeft"&&e.preventDefault(),e.code==="Backspace"&&(s.value[t-1]="",l.value!==null&&t>1)){const a=l.value.children[t-2].querySelector("input");a&&a.focus()}if(/^([0-9])$/.test(e.key)&&(s.value[t-1]=e.key,l.value!==null&&t!==0&&t<l.value.children.length)){const a=l.value.children[t].querySelector("input");a&&a.focus()}console.log(s.value.join("")),k("updateOtp",s.value.join(""))},{t:i}=T(),C=()=>{r.post("/activate-account",{code:s.value.join("")}).then(e=>{const{accessToken:t,userData:o,userAbilities:a}=e.data;return localStorage.setItem("userAbilities",JSON.stringify(a)),x.update(a),localStorage.setItem("userData",JSON.stringify(o)),localStorage.setItem("accessToken",t),N.set("auth",t),o.role==="client"?g.replace(c.query.to?String(c.query.to):"/dashboards/apps/profile/my"):g.replace(c.query.to?String(c.query.to):"/customers/my"),null}).catch(e=>{errors.value=e.response.data.message})},A=()=>{C()};return(e,t)=>(d(),_("div",null,[n("h6",J,p(u(i)("Type your 6 digit security code")),1),n("div",{ref_key:"refOtpComp",ref:l,class:"d-flex align-center gap-4"},[(d(!0),_(j,null,B(y.totalInput,o=>(d(),E(F,R({key:o,"model-value":u(s)[o-1]},V,{maxlength:"1",onKeydown:a=>w(a,o)}),null,16,["model-value","onKeydown"]))),128))],512),m(v,{cols:"12"},{default:f(()=>[m(K,{block:"",onClick:A,type:"submit"},{default:f(()=>[D(p(u(i)("Verify my account")),1)]),_:1})]),_:1}),m(v,{cols:"12"},{default:f(()=>[n("div",P,[n("span",U,p(u(i)("Didnt get the code?")),1),n("a",W,p(u(i)("Resend")),1)])]),_:1})]))}};export{X as _};
